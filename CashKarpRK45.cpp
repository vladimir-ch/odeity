#include "CashKarpRK45.h"

CashKarpRK45::CashKarpRK45()
  : ExplicitRungeKuttaBase( 4, 6, true ) // 4th order, 6 stages, FSAL true
{
  solverName_ = "Runge-Kutta 5(4) (by Cash-Karp)";

  c_(0) = 0.0;
  c_(1) = 1.0/5.0;
  c_(2) = 3.0/10.0;
  c_(3) = 3.0/5.0;
  c_(4) = 1.0;
  c_(5) = 7.0/8.0;
  
  b_(0) = 37.0/378.0;
  b_(1) = 0.0; 
  b_(2) = 250.0/621.0;
  b_(3) = 125.0/594.0;
  b_(4) = 0.0; 
  b_(5) = 512.0/1771.0; 

  e_(0) = -277.0/64512.0;
  e_(1) =  0.0;
  e_(2) =  6925/370944;
  e_(3) = -6925.0/202752.0;
  e_(4) = -277.0/14336.0;
  e_(5) =  277.0/7084.0;
  
  a_(0,0) = 0.0;     a_(0,1) = 0.0;     a_(0,2) = 0.0;     a_(0,3) = 0.0;
  a_(1,0) = 1.0/5.0; a_(1,1) = 0.0;     a_(1,2) = 0.0;     a_(1,3) = 0.0;
  a_(2,0) = 3.0/40.0;  a_(2,1) = 9.0/40.0; a_(2,2) = 0.0;     a_(2,3) = 0.0;
  a_(3,0) = 3.0/10.0; a_(3,1) = -9.0/10.0; a_(3,2) = 6.0/5.0; a_(3,3) = 0.0;
  a_(4,0) = -11.0/54.0; a_(4,1) = 5.0/2.0; a_(4,2) = -70.0/27.0; a_(4,3) = 35.0/27.0; a_(4,4) = 0;
  a_(5,0) = 1631.0/55296.0; a_(5,1) = 175.0/512.0; a_(5,2) = 575.0/13824.0; a_(5,3) = 44275.0/110592.0; a_(5,4) = 253.0/4096.0; a_(5,5) = 0.0;
}

OdeIntegratorBase * createCashKarpRK45Solver()
{
    return new CashKarpRK45();
}
